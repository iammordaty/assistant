{% extends '@common/layout.twig' %}

{% block title %}Mix{% endblock %}

{% block contentBlock %}
    <style>
        table {
            overflow: hidden;
            z-index: 1;
        }
        td, th {
            position: relative;
        }
        td:hover::after {
            background-color: #f5f5f5;
            content: '\00a0';
            height: 10000px;
            left: 0;
            position: absolute;
            top: -5000px;
            width: 100%;
            z-index: -1;
        }
    </style>

    <h3>Tracklista</h3>

    <form method="POST">
        <textarea name="listing" style="width: 100%; height: 250px">{{ listing }}</textarea>
        <footer>
            <button type="submit" name="submit" value="true" class="btn btn-default btn-lg pull-right">Prześlij</button>
        </footer>
    </form>
    <div class="clearfix"></div>

    {% if mix %}
        <h3>Znalezione utwory</h3>

        <ol>
            {% for track in tracks %}
                <li>
                    <a href="{{ urlFor('track.track.index', { guid: track.track.guid } )}}" class="undecorated">{{ track.track.artist }} - {{ track.track.title }}</a>
                    {%- if loop.index0 > 0 %} ({{ track.similarityValue }}%){% endif %}
                </li>
            {% endfor %}
        </ol>

        <h3>Siatka podobieństwa</h3>

        <table class="table table-hover" style="font-size: 10px">
            <tr>
                <td>&nbsp;</td>
                {% for row in matrix %}
                    <td title="{{ row.track.artist }} - {{ row.track.title}}">{{ row.track.title }}</td>
                {% endfor %}
            </tr>
            {% for row in matrix %}
                <tr>
                    <td title="{{ row.track.artist }} - {{ row.track.title}}">{{ row.track.title }}</td>
                    {% for track in row.tracks %}
                        <td class="text-center" {% if track.similarityValue is empty %}style="background-color: #eaeaea"{% endif %}>{{ track.similarityValue|default('-') }}</td>
                    {% endfor %}
                </tr>
            {% endfor %}
        </table>

        <h3>Mix</h3>

        <ol>
            {% for track in mix %}
                <li>
                    <a href="{{ urlFor('track.track.index', { guid: track.track.guid } )}}" class="undecorated">{{ track.track.artist }} - {{ track.track.title }}</a>
                    {%- if loop.index0 > 0 %} ({{ track.similarityValue }}%){% endif %}
                </li>
            {% endfor %}
        </ol>
    {% endif %}
{% endblock %}